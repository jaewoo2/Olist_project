# Olist 데이터 전처리 및 특성 공학 상세 보고서 (v4)

본 보고서는 Olist 데이터셋의 8개 테이블에 대해 수행된 데이터 정제(Data Cleaning), 이상치 처리(Outlier Handling) 및 특성 공학(Feature Engineering) 작업을 **테이블별로 상세하게** 기록합니다. 특히, v4에서는 2017년 이후 안정화된 데이터를 기준으로 한 최종 필터링 과정을 중점적으로 다룹니다.

**버전:** 4.0 (2017년 이후 안정기 데이터 필터링 완료)  
**최종 수정일:** 2026-01-31

---

## 📊 전처리 요약 (v4 업데이트)

| 테이블 | 주요 처리 | 제거/변환 건수 | 영향도 |
|--------|-----------|----------------|--------|
| Products | 결측치 대체 | 610건 (카테고리), 2건 (수치형) | 낮음 |
| **Orders** | **2017년 이후 필터링** + 상태 필터링 | 약 263건 (2016년 데이터 추가 제외) | 낮음 (데이터 안정성 확보) |
| Order Reviews | 중복 제거 완료 | 551건 (최신 리뷰 유지) | 0.6% |
| **Master Tables** | **2017년 이후 데이터 생성** | **최종 분석용 마스터 생성** | **높음 (팀 표준 데이터)** |

---

## 1. 데이터 기간 필터링 (2017년 1월 ~) ✅ v4 NEW

분석의 정확도와 데이터의 안정성을 위해 2016년 데이터를 제외하고 **2017년 1월 1일 이후 주문**만 사용하기로 결정했습니다.

### **필터링 근거**
1. **데이터 양의 불균형**: 2016년은 플랫폼 운영 초기 단계로 데이터 건수가 매우 적어 전체 통계를 왜곡할 위험이 있음.
2. **운영 안정성**: 2017년부터 주문량이 급증하며 시스템이 안정화된 것으로 판단됨.
3. **지표 신뢰도**: 배송 소요 시간 등 성과 지표 산정 시 불규칙한 초기 데이터를 배제하여 신뢰도를 높임.

### **필터링 결과**
- **대상**: `order_purchase_timestamp >= '2017-01-01'`
- **최종 order 건수**: 95,082건 → **94,819건** (약 263건 제외)

---

## 2. Orders (주문) 테이블

### **데이터 필터링 (Data Filtering)**
- **주문 상태**: 'delivered' 상태만 유지 (97.0% 점유)
- **날짜 결측 제거**: 배송 기간 산출 불가 데이터 제거
- **기간 필터링**: 2017년 01월 01일 이후 주문 한정

### **이상치 처리 (Outlier Handling)**
- **논리적 오류 제거**: 총 배송 시간, 판매자 준비 시간 등이 음수인 데이터(1,373건) 제거

### **특성 공학 (Feature Engineering)**
- **배송 관련**: `total_delivery_time`, `seller_prep_time`, `pure_shipping_time`, `delivery_accuracy`
- **지연 및 속도**: `is_delayed`, `delivery_speed_type` (4단계: Very Fast, Normal, Slow, Very Slow)
- **시간 관련**: `purchase_hour`, `purchase_dayofweek`, `purchase_month`, `is_weekend`

---

## 3. 마스터 테이블 생성 (2017년 이후 데이터) ✅ v4 UPDATE

사용자 정의 필터링을 거친 최종 분석용 마스터 테이블입니다.

### **3-1. master_orders_begin2017**
**용도:** 주문/배송/리뷰/고객 경험 분석  
**단위:** 1행 = 1주문  
**건수:** 94,819건  
**경로:** `data/master_begin2017/master_orders_begin2017.csv`

#### 특이사항 분석 (결측치 1건의 비밀)
- **결제 정보(1건)**: `orders`에는 존재하나 `order_payments` 테이블에 기록이 없는 1건의 주문이 결측치로 발생.
- **분석적 판단**: 시스템 누락으로 판단하여 제거 가능.

---

### **3-2. master_sellers_begin2017**
**용도:** 판매자 성과 분석 및 관리  
**단위:** 1행 = 1판매자  
**건수:** 2,959건 (활동 판매자 한정)  
**경로:** `data/master_begin2017/master_sellers_begin2017.csv`

#### 활동 판매자 필터링 (136명 제외)
- **배경**: 전체 판매자 3,095명 중 2017년 이후 '배송 완료' 기록이 없는 판매자가 136명 존재.
- **조치**: 분석의 정합성을 위해 실제 활동 기록이 있는 **2,959명**만 마스터 테이블에 포함.

#### 주요 지표
- **GMV**: 상품가 + 배송비 합계 (총 거래액)
- **Five Star Rate**: 5점 리뷰 비율
- **Delay Rate**: 배송 지연 발생 비율 (지연 건수 / 전체 주문 수)

---

## 4. 데이터 보급 가이드 (팀 공유용)

### **날짜 데이터 타입 변환**
팀원들의 분석 편의성을 위해 다음 4개 컬럼을 `object`에서 `datetime64[ns]` 타입으로 변환하여 배포합니다.
- `order_approved_at`
- `order_delivered_carrier_date`
- `order_delivered_customer_date`
- `order_estimated_delivery_date`

### **한글 인코딩**
엑셀 등에서의 가독성을 위해 `utf-8-sig` 인코딩으로 저장되었습니다.

---

## 📁 최종 산출물 경로

```
📁 project_root
│
└── 📂 data/
    └── 📂 master_begin2017/  <-- 분석용 최종 데이터
        ├── master_orders_begin2017.csv (94,819건)
        └── master_sellers_begin2017.csv (2,959건)
```

---

**문서 버전:** 4.0  
**작성일:** 2026-01-31  
**변경 이력:**
- v3.0: 리뷰 중복 제거 완료, 마스터 테이블 생성 추가
- v4.0: 2017년 필터링 적용, 미활동 판매자 제외, 팀 배포용 데이터 정비 추가
